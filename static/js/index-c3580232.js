import{a as C}from"./index-02179bb8.js";import{d as B,h as l,k as M,r as i,M as N,o as w,c as R,a,w as u,N as A,m as D,q as E,aS as V,f as q,x as z,aT as I,aU as O}from"./index-3273f717.js";const Q={class:"app-container"},U={style:{"margin-top":"20px"}},F=B({name:"PermManage",__name:"index",setup(j){const m=l(),d=l(!1);let r=[];const h=l(0),_=l([]);async function y(){d.value=!0;const{error:o,data:e}=await C.query({operationName:"System/Operation/GetMany"});o||(r=e.data,h.value=r.length,b(),I().then(t=>{const c=t.data.data.map(n=>n.path)??[];_.value=c;const p=r.filter(n=>c.includes(n.title));for(const n of p)m.value.toggleRowSelection(n,!0)})),d.value=!1}M(()=>{y()});let g=[];const S=o=>{g=o,_.value=o.map(e=>{e.title})};let v=[];const k=()=>{g.forEach(e=>{const t={id:e.id,createdAt:new Date(e.createTime).toISOString(),enabled:e.enabled?1:0,method:e.method,path:e.title};v.push(t)}),O({data:v}).then(e=>{})};l();const s=l(1),f=l(10),b=()=>r.slice((s.value-1)*f.value,s.value*f.value),x=o=>o.title;return(o,e)=>{const t=i("el-table-column"),c=i("el-pagination"),p=i("el-button"),n=i("el-card"),T=N("loading");return w(),R("div",Q,[a(n,{shadow:"never"},{default:u(()=>[A((w(),D(E(V),{ref_key:"dataTableRef",ref:m,data:b(),onSelectionChange:S,"row-key":x,"highlight-current-row":"",border:""},{default:u(()=>[a(t,{label:"勾选",type:"selection","reserve-selection":!0}),a(t,{label:"请求路径",prop:"title",width:"250"}),a(t,{label:"Method",prop:"method",width:"150"}),a(t,{label:"请求类型",prop:"operationType"}),a(t,{label:"是否实时",prop:"liveQuery",width:"100"}),a(t,{label:"是否启用",prop:"enabled",width:"100"})]),_:1},8,["data"])),[[T,d.value]]),a(c,{small:"",background:"",layout:"prev, pager, next","current-page":s.value,"onUpdate:currentPage":e[0]||(e[0]=P=>s.value=P),total:h.value,size:10,class:"mt-4"},null,8,["current-page","total"]),q("div",U,[a(p,{onClick:k},{default:u(()=>[z("勾选项同步到数据库")]),_:1})])]),_:1})])}}});export{F as default};
